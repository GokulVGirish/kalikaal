<%- include("../partials/adminHeader") %>
  <section class="content-main">
        <div class="content-header">
            <div>
                <h2 class="content-title card-title">Dashboard </h2>
                <p>Whole data about your business here</p>
            </div>
         
        </div>
        <!-- <div class="row">
            <div class="col-lg-3">
                <div class="card card-body mb-4">
                    <article class="icontext">
                        <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-success material-icons md-local_shipping"></i></span>
                        <div class="text">
                            <h6 class="mb-1 card-title">Orders</h6> <span>53.668</span>
                            
                            <span class="text-sm">
                                Excluding orders in transit
                            </span>
                        </div>
                    </article>
                </div>
            </div>
            <div class="col-lg-3">
                <div class="card card-body mb-4">
                    <article class="icontext">
                        <span class="icon icon-sm rounded-circle bg-success-light"><i class="text-warning material-icons md-qr_code"></i></span>
                        <div class="text">
                            <h6 class="mb-1 card-title">Products</h6> <span>9.856</span>
                            <span class="text-sm">
                                In 19 Categories
                            </span>
                        </div>
                    </article>
                </div>
            </div>
            <div class="col-lg-3">
                <div class="card card-body mb-4">
                    <article class="icontext">
                        <span class="icon icon-sm rounded-circle bg-warning-light"><i class="text-info material-icons md-shopping_basket"></i></span>
                        <div class="text">
                            <h6 class="mb-1 card-title">Total Earning</h6> <span>9.856</span>
                            <span class="text-sm">
                                Based in your local time.
                            </span>
                        </div>
                    </article>
                </div>
            </div> -->
            <!-- <div class="col-lg-3">
                <div class="card card-body mb-4">
                    <article class="icontext">
                        <span class="icon icon-sm rounded-circle bg-info-light"><i class="text-info material-icons md-shopping_basket"></i></span>
                        <div class="text">
                            <h6 class="mb-1 card-title">Monthly Earning</h6> <span>$6,982</span>
                            <span class="text-sm">
                                Based in your local time.
                            </span>
                        </div>
                    </article>
                </div> -->
            </div>
        </div>
        <div class="row">
            <div class="col-xl-8 col-lg-12">
                <div class="card mb-4">
                    <article class="card-body">
                        <h5 class="card-title">Monthly statistics</h5>
                        <canvas id="myChart" height="120px"></canvas>
                       <input type="hidden" value="<%= JSON.stringify(salesReport) %>" id="salesReport">
                    </article>
                </div>
                <div class="card mb-4">
                    <article class="card-body">
                        <h5 class="card-title">yearly statistics</h5>
                        <canvas id="yearlySales" height="120px"></canvas>
                        <input type="hidden" value="<%=JSON.stringify(yearly)%>" id="yearlyReport">

                    </article>
                </div>
                <div class="card mb-4">
                    <article class="card-body">
                        <h5 class="card-title">Weekly statistics</h5>
                        <canvas id="weeklySales" height="120px"></canvas>
                        <input type="hidden" value="<%=JSON.stringify(weekly)%>" id="weeklyReport">

                    </article>
                </div>
                <div class="row">
                    <div class="col-lg-5">
                        <div class="card mb-4">
                            <article class="card-body">
                                <h5 class="card-title">Best Selling Products</h5>
                               <div class="new-member-list">
    <% for (let i = 0; i < bestSellingProduct.length; i++) { %>
        <div class="d-flex align-items-center mb-4">
            <img src="/public/uploads/product-images/<%= bestSellingProduct[i]._id.productImage[0] %>" alt="" class="avatar">
            <div>
                <h6><%= bestSellingProduct[i]._id.productName %></h6>
            </div>
        </div>
    <% } %>
</div>

                            </article>
                        </div>
                    </div>
                    <div class="col-lg-7">
                        <div class="card mb-4">
                            <article class="card-body">
                                <h5 class="card-title">Best selling Brands</h5>
                                <canvas id="brand" height="217"></canvas>
                                <input type="hidden" value="<%= JSON.stringify(brand) %>" id="branddata">


                            </article>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4 col-lg-12">
                <div class="card mb-4">
                    <article class="card-body">
                        <h5 class="card-title">Order Status</h5>
                        <canvas id="myDoughnutChart" height="217"></canvas>
                        <input type="hidden" value="<%= JSON.stringify(order) %>" id="order">
                    </article>
                </div>
                <div class="card mb-4">
                    <article class="card-body">
                        <h5 class="card-title">Category selling</h5>
                        <input type="hidden"value="<%= JSON.stringify(category) %>" id="category">
                        <canvas id="progresschart" height="217"></canvas>
                        
                    </article>
                </div>
            </div>
        </div>
      <!-- <div class="card mb-4">
            <header class="card-header">
                <h4 class="card-title">Latest orders</h4>
                <div class="row align-items-center">
                    <div class="col-md-3 col-12 me-auto mb-md-0 mb-3">
                        <div class="custom_select">
                            <select class="form-select select-nice">
                                <option selected>All Categories</option>
                                <option>Women's Clothing</option>
                                <option>Men's Clothing</option>
                                <option>Cellphones</option>
                                <option>Computer & Office</option>
                                <option>Consumer Electronics</option>
                                <option>Jewelry & Accessories</option>
                                <option>Home & Garden</option>
                                <option>Luggage & Bags</option>
                                <option>Shoes</option>
                                <option>Mother & Kids</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-2 col-6">
                        <input type="date" value="02.05.2021" class="form-control">
                    </div>
                    <div class="col-md-2 col-6">
                        <div class="custom_select">
                            <select class="form-select select-nice">
                                <option selected>Status</option>
                                <option>All</option>
                                <option>Paid</option>
                                <option>Chargeback</option>
                                <option>Refund</option>
                            </select>
                        </div>
                    </div>
                </div>
            </header>
             <div class="card-body">
                <div class="table-responsive">
                    <div class="table-responsive">
                        <table class="table align-middle table-nowrap mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th scope="col" class="text-center">
                                        <div class="form-check align-middle">
                                            <input class="form-check-input" type="checkbox" id="transactionCheck01">
                                            <label class="form-check-label" for="transactionCheck01"></label>
                                        </div>
                                    </th>
                                    <th class="align-middle" scope="col">Order ID</th>
                                    <th class="align-middle" scope="col">Billing Name</th>
                                    <th class="align-middle" scope="col">Date</th>
                                    <th class="align-middle" scope="col">Total</th>
                                    <th class="align-middle" scope="col">Payment Status</th>
                                    <th class="align-middle" scope="col">Payment Method</th>
                                    <th class="align-middle" scope="col">View Details</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="transactionCheck02">
                                            <label class="form-check-label" for="transactionCheck02"></label>
                                        </div>
                                    </td>
                                    <td><a href="#" class="fw-bold">#SK2540</a> </td>
                                    <td>Neal Matthews</td>
                                    <td>
                                        07 Oct, 2021
                                    </td>
                                    <td>
                                        $400
                                    </td>
                                    <td>
                                        <span class="badge badge-pill badge-soft-success">Paid</span>
                                    </td>
                                    <td>
                                        <i class="material-icons md-payment font-xxl text-muted mr-5"></i> Mastercard
                                    </td>
                                    <td>
                                        <a href="#" class="btn btn-xs"> View details</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="transactionCheck03">
                                            <label class="form-check-label" for="transactionCheck03"></label>
                                        </div>
                                    </td>
                                    <td><a href="#" class="fw-bold">#SK2541</a> </td>
                                    <td>Jamal Burnett</td>
                                    <td>
                                        07 Oct, 2021
                                    </td>
                                    <td>
                                        $380
                                    </td>
                                    <td>
                                        <span class="badge badge-pill badge-soft-danger">Chargeback</span>
                                    </td>
                                    <td>
                                        <i class="material-icons md-payment font-xxl text-muted mr-5"></i> Visa
                                    </td>
                                    <td>
                                        <a href="#" class="btn btn-xs"> View details</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="transactionCheck04">
                                            <label class="form-check-label" for="transactionCheck04"></label>
                                        </div>
                                    </td>
                                    <td><a href="#" class="fw-bold">#SK2542</a> </td>
                                    <td>Juan Mitchell</td>
                                    <td>
                                        06 Oct, 2021
                                    </td>
                                    <td>
                                        $384
                                    </td>
                                    <td>
                                        <span class="badge badge-pill badge-soft-success">Paid</span>
                                    </td>
                                    <td>
                                        <i class="material-icons md-payment font-xxl text-muted mr-5"></i> Paypal
                                    </td>
                                    <td>
                                        <a href="#" class="btn btn-xs"> View details</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="transactionCheck05">
                                            <label class="form-check-label" for="transactionCheck05"></label>
                                        </div>
                                    </td>
                                    <td><a href="#" class="fw-bold">#SK2543</a> </td>
                                    <td>Barry Dick</td>
                                    <td>
                                        05 Oct, 2021
                                    </td>
                                    <td>
                                        $412
                                    </td>
                                    <td>
                                        <span class="badge badge-pill badge-soft-success">Paid</span>
                                    </td>
                                    <td>
                                        <i class="material-icons md-payment font-xxl text-muted mr-5"></i> Mastercard
                                    </td>
                                    <td>
                                        <a href="#" class="btn btn-xs"> View details</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="transactionCheck06">
                                            <label class="form-check-label" for="transactionCheck06"></label>
                                        </div>
                                    </td>
                                    <td><a href="#" class="fw-bold">#SK2544</a> </td>
                                    <td>Ronald Taylor</td>
                                    <td>
                                        04 Oct, 2021
                                    </td>
                                    <td>
                                        $404
                                    </td>
                                    <td>
                                        <span class="badge badge-pill badge-soft-warning">Refund</span>
                                    </td>
                                    <td>
                                        <i class="material-icons md-payment font-xxl text-muted mr-5"></i> Visa
                                    </td>
                                    <td>
                                        <a href="#" class="btn btn-xs"> View details</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-center">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="transactionCheck07">
                                            <label class="form-check-label" for="transactionCheck07"></label>
                                        </div>
                                    </td>
                                    <td><a href="#" class="fw-bold">#SK2545</a> </td>
                                    <td>Jacob Hunter</td>
                                    <td>
                                        04 Oct, 2021
                                    </td>
                                    <td>
                                        $392
                                    </td>
                                    <td>
                                        <span class="badge badge-pill badge-soft-success">Paid</span>
                                    </td>
                                    <td>
                                        <i class="material-icons md-payment font-xxl text-muted mr-5"></i> Paypal
                                    </td>
                                    <td>
                                        <a href="#" class="btn btn-xs"> View details</a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div> table-responsive end// 
            </div> 
        </div>-->
        <!-- <div class="pagination-area mt-30 mb-50">
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-start">
                    <li class="page-item active"><a class="page-link" href="#">01</a></li>
                    <li class="page-item"><a class="page-link" href="#">02</a></li>
                    <li class="page-item"><a class="page-link" href="#">03</a></li>
                    <li class="page-item"><a class="page-link dot" href="#">...</a></li>
                    <li class="page-item"><a class="page-link" href="#">16</a></li>
                    <li class="page-item"><a class="page-link" href="#"><i class="material-icons md-chevron_right"></i></a></li>
                </ul>
            </nav>
        </div>  -->
    </section> <!-- content-main end// -->
    


     
        <!-- <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                    document.write(new Date().getFullYear())
                    </script> ©, Evara - HTML Ecommerce Template .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div> -->
        </footer>
    </main>
    <script src="/public/admin-assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="/public/admin-assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="/public/admin-assets/js/vendors/select2.min.js"></script>
    <script src="/public/admin-assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="/public/admin-assets/js/vendors/jquery.fullscreen.min.js"></script>
    <script src="/public/admin-assets/js/vendors/chart.js"></script>
    <!-- Main Script -->
    <script src="/public/admin-assets/js/main.js" type="text/javascript"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <!-- <script src="/public/admin-assets/js/custom-chart.js" type="text/javascript"></script> -->
    <script>

//yearly sorting

if ($('#yearlySales').length) {
    const yearlyReport = JSON.parse(document.getElementById("yearlyReport").value)
    const currentYear = new Date().getFullYear()
    
    let labels = []
    let totalAmount =[]
    const color = [
                'rgba(255, 99, 132, 0.2)',
                'rgba(255, 159, 64, 0.2)',
                'rgba(255, 205, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(201, 203, 207, 0.2)'
            ]
  let colors =[]
  let borderColor =[
                'rgb(255, 99, 132)',
                'rgb(255, 159, 64)',
                'rgb(255, 205, 86)',
                'rgb(75, 192, 192)',
                'rgb(54, 162, 235)',
                'rgb(153, 102, 255)',
                'rgb(201, 203, 207)'
            ]
            let borderColors =[]
    for(let i =0;i< yearlyReport.length;i++){
        labels.push(yearlyReport[i]._id)
        totalAmount.push(yearlyReport[i].totalAmount)
        colors.push(color[i])
        borderColors.push(borderColor[i])
    }
    const data = {
        labels: labels,
        datasets: [{
            label: 'year',
            data: totalAmount,
            backgroundColor: colors,
            borderColor: borderColors,
            borderWidth: 1
        }]
    };

    const config = {
        type: 'bar',
        data: data,
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    };

    // Render the chart
    var ctx = document.getElementById('yearlySales').getContext('2d');
    var myChart = new Chart(ctx, config);
}


//weeklySales

if ($('#weeklySales').length) {

    const weekDataString = document.getElementById("weeklyReport").value
    const { weeklyDatas, DatNum } = JSON.parse(weekDataString);
    let weeklyTotalAmount =[]
   for(let i =0;i< weeklyDatas.length;i++){
      weeklyTotalAmount.push(weeklyDatas[i].totalAmount)
   }
    let date=[]
    for(let i=0;i<DatNum.length;i++){
        date.push(`week ${DatNum[i]}`)

   }
  



  const labels = date; 
  const data = {
    labels: labels,
    datasets: [{
      label: 'week',
      data: weeklyTotalAmount,
      fill: false,
      borderColor: 'rgb(75, 192, 192)',
      tension: 0.1
    }]
  };

  const config = {
    type: 'line',
    data: data,
  };

  const weekly = document.getElementById('weeklySales').getContext('2d');
  var myChart = new Chart(weekly, config);
}


















    
    
        // Sale statistics Chart 1
        if ($('#myChart').length) {
            const salesReport =  JSON.parse( document.getElementById("salesReport").value)
          var ctx = document.getElementById('myChart').getContext('2d');
          const allMonths = Array.from({ length: 12 }, (_, i) => i + 1); // Array representing all months (1 to 12)
    const monthlyDataMap = new Map(salesReport.map(item => [item._id, item.totalAmount]));
    const monthlyDataFilled = allMonths.map(month => ({ _id: month, totalAmount: monthlyDataMap.get(month) || 0 }));
          var chart = new Chart(ctx, {
            type: 'line',
            data: {
              labels:monthlyDataFilled.map((product)=>product._id),
              datasets: [{
                  label: 'Sales',
                  tension: 0.3,
                  fill: true,
                  backgroundColor: 'rgba(44, 120, 220, 0.2)',
                  borderColor: 'rgba(44, 120, 220)',
                  data: monthlyDataFilled.map((product)=>product.totalAmount)
                },
                
              ]
            },
            options: {
              plugins: {
                legend: {
                  labels: {
                    usePointStyle: true,
                  },
                }
              }
            }
          });
        }
      
       
      
        // Doughnut Chart
        var ctxDoughnut = document.getElementById('myDoughnutChart').getContext('2d');
        const orderString = document.getElementById("order").value
        const order = JSON.parse(orderString)
        const colory =  [
              'rgb(20, 229, 34)',
              'rgb(255, 148, 6)',
              'rgb(20, 83, 229)',
              'rgb(255, 6, 6)',
              'rgb(229, 20, 139)'
            ]
        let colors = [] 
        let status = []
        let count = []
        for(let i =0;i< order.length;i++){
            status.push(order[i]._id)
            colors.push(colory[i])
            count.push(order[i].count)
        }
        
        var doughnutData = {
          labels: status,
          datasets: [{
            label: 'My First Dataset',
            data: count,
            backgroundColor:colors,
            hoverOffset: 4
          }]
        };
      
        var doughnutConfig = {
          type: 'doughnut',
          data: doughnutData,
        };
      
        var myDoughnutChart = new Chart(ctxDoughnut, doughnutConfig);
     
        



        // Pie Chart
        const categoryString = document.getElementById("category").value;
        const category = JSON.parse(categoryString);

// Now you can access the individual objects in the array
let categoryName =[]
let colours =[]
let colour = [
              'rgb(0,139,139)',
                'rgb(124,252,0)',
                'rgb(255,165,0)'
              ]
let categoryCount = []
for (let i = 0; i < category.length; i++) {
    categoryName.push(category[i]._id.name)
    colours.push(colour[i])
    categoryCount.push(category[i].count)

}
     
        const pieConfig = {
          type: 'pie',
          data: {
            labels: categoryName,
            datasets: [{
              label: 'My First Dataset',
              data: categoryCount,
              backgroundColor: colours,
              hoverOffset: 4
            }]
          },
        };
    
      
        // Get the canvas element by id
        var progressChart = document.getElementById('progresschart').getContext('2d');
      
        // Create a new Chart instance for the pie chart
        var myPieChart = new Chart(progressChart, pieConfig);










 const brandCtx = document.getElementById('brand').getContext('2d');
 const branddstring = document.getElementById("branddata").value
 const brand = JSON.parse(branddstring)
 let counts =[]
 const bColor = [
      'rgb(255, 99, 132)',
      'rgb(54, 162, 235)',
      'rgb(255, 205, 86)'
    ]
let bColors =[]
 let brandName =[]
 for(let i=0;i< brand.length;i++){
    counts.push(brand[i].count)
    brandName.push(brand[i]._id.brandName)
    bColors.push(bColor[i])
 }
const brandData = {
  labels:brandName, // Replace with your brand names
  datasets: [{
    label: 'Best Selling Brands',
    data: counts, // Replace with your actual sales data for each brand
    backgroundColor:bColors,
    hoverOffset: 4
  }]
};

const brandConfig = {
  type: 'doughnut',
  data: brandData,
};

const brandChart = new Chart(brandCtx, brandConfig);






















      </script>
      
</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:57 GMT -->
</html>